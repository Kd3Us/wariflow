import{a as re,b as ae,c as oe,d as se,e as le,f as ke}from"./chunk-6AYNKTF7.js";import"./chunk-5PVWWKIE.js";import{a as xe,b as he}from"./chunk-WEN37R3V.js";import{Ca as a,Ga as F,Ka as j,Kb as Y,Lb as I,Mb as P,Na as x,Nb as Z,Ob as D,R as q,Ta as m,Ua as J,Ub as ee,Vb as te,W as G,Xa as n,Ya as r,Yb as ie,Za as N,Zb as ne,_b as de,a as C,ab as b,ac as L,b as V,ba as c,bb as _,bc as me,ca as p,cb as f,dc as ce,fc as B,gb as M,gc as pe,hb as s,hc as ue,ib as k,j as $,jb as h,ka as S,lb as v,mb as y,mc as O,nb as w,nc as H,oc as U,pc as ge,qb as K,qc as fe,rb as E,rc as _e,sb as Q,tb as X,tc as W}from"./chunk-YALM3UWZ.js";var T=function(i){return i.PENDING="PENDING",i.INPROGRESS="INPROGRESS",i.TEST="TEST",i.DONE="DONE",i}(T||{});var we=(i,u,e)=>({"bg-red-100 text-red-800":i,"bg-yellow-100 text-yellow-800":u,"bg-green-100 text-green-800":e}),Ce=(i,u)=>({"text-red-500":i,"text-yellow-500":u});function Se(i,u){if(i&1&&(n(0,"p",18),s(1),r()),i&2){let e=f();a(),h(" ",e.task.description," ")}}function Me(i,u){if(i&1&&(n(0,"div",19)(1,"div",20)(2,"span",21),s(3,"Progression"),r(),n(4,"span",22),s(5),r()(),n(6,"div",23),N(7,"div",24),r()()),i&2){let e=f();a(5),h("",e.task.progress,"%"),a(2),J("width",e.task.progress,"%")}}function Ee(i,u){if(i&1&&(n(0,"span"),s(1),r()),i&2){let e=f(2);a(),h("Est: ",e.task.estimatedHours,"h")}}function je(i,u){if(i&1&&(n(0,"span"),s(1),r()),i&2){let e=f(2);a(),h("Act: ",e.task.actualHours,"h")}}function Ie(i,u){if(i&1&&(n(0,"div",25),x(1,Ee,2,1,"span",26)(2,je,2,1,"span",26),r()),i&2){let e=f();a(),m("ngIf",e.task.estimatedHours),a(),m("ngIf",e.task.actualHours)}}function Pe(i,u){if(i&1&&(n(0,"span",30),s(1),r()),i&2){let e=u.$implicit;a(),h(" ",e," ")}}function De(i,u){if(i&1&&(n(0,"span",30),s(1),r()),i&2){let e=f(2);a(),h(" +",e.task.tags.length-3," ")}}function Ve(i,u){if(i&1&&(n(0,"div",27),x(1,Pe,2,1,"span",28)(2,De,2,1,"span",29),r()),i&2){let e=f();a(),m("ngForOf",e.task.tags.slice(0,3)),a(),m("ngIf",e.task.tags.length>3)}}function Fe(i,u){if(i&1&&(n(0,"div",34),s(1),r()),i&2){let e,o=u.$implicit;m("title",o.name),a(),h(" ",o==null||o.name==null||(e=o.name.charAt(0))==null?null:e.toUpperCase()," ")}}function Ne(i,u){if(i&1&&(n(0,"div",35),s(1),r()),i&2){let e=f(2);a(),h(" +",e.task.assignedTo.length-3," ")}}function Le(i,u){if(i&1&&(n(0,"div",31),x(1,Fe,2,2,"div",32)(2,Ne,2,1,"div",33),r()),i&2){let e=f();a(),m("ngForOf",e.task.assignedTo.slice(0,3)),a(),m("ngIf",e.task.assignedTo.length>3)}}function Be(i,u){if(i&1&&(n(0,"span",36)(1,"span",37),s(2,"schedule"),r(),s(3),r()),i&2){let e=f();m("ngClass",K(2,Ce,e.isOverdue(e.task.deadline),e.isDueSoon(e.task.deadline))),a(3),h(" ",e.formatDate(e.task.deadline)," ")}}function Oe(i,u){if(i&1&&(n(0,"span",38)(1,"span",37),s(2,"comment"),r(),s(3),r()),i&2){let e=f();a(3),h(" ",e.task.comments," ")}}function He(i,u){if(i&1&&(n(0,"span",38)(1,"span",37),s(2,"attach_file"),r(),s(3),r()),i&2){let e=f();a(3),h(" ",e.task.attachments," ")}}function Ue(i,u){if(i&1){let e=b();n(0,"div",39)(1,"button",40),_("click",function(){c(e);let t=f();return p(t.onEdit())}),n(2,"span",37),s(3,"edit"),r(),s(4," Modifier "),r(),n(5,"button",41),_("click",function(){c(e);let t=f();return p(t.onDelete())}),n(6,"span",37),s(7,"delete"),r(),s(8," Supprimer "),r()()}}var be=(()=>{class i{constructor(){this.edit=new S,this.delete=new S,this.removeUser=new S,this.showMenu=!1}toggleMenu(e){e.stopPropagation(),this.showMenu=!this.showMenu}onEdit(){this.showMenu=!1,this.edit.emit(this.task)}onDelete(){this.showMenu=!1,this.delete.emit(this.task)}isOverdue(e){return new Date(e)<new Date}isDueSoon(e){let o=new Date,l=new Date(e).getTime()-o.getTime(),g=Math.ceil(l/(1e3*60*60*24));return g<=2&&g>0}formatDate(e){let o=new Date,t=new Date(e),l=t.getTime()-o.getTime(),g=Math.ceil(l/(1e3*60*60*24));return g===0?"Aujourd'hui":g===1?"Demain":g===-1?"Hier":g<-1?`Il y a ${Math.abs(g)} jours`:g<=7?`Dans ${g} jours`:t.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=j({type:i,selectors:[["app-task-card"]],inputs:{task:"task"},outputs:{edit:"edit",delete:"delete",removeUser:"removeUser"},decls:22,vars:16,consts:[[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","p-4","cursor-pointer","hover:shadow-md","transition-shadow"],[1,"flex","justify-between","items-start","mb-3"],[1,"font-medium","text-gray-900","text-sm","line-clamp-2","flex-1","mr-2"],[1,"px-2","py-1","text-xs","font-medium","rounded-full","flex-shrink-0",3,"ngClass"],["class","text-gray-600 text-xs mb-3 line-clamp-2",4,"ngIf"],["class","mb-3",4,"ngIf"],["class","flex justify-between text-xs text-gray-500 mb-3",4,"ngIf"],["class","flex flex-wrap gap-1 mb-3",4,"ngIf"],[1,"flex","justify-between","items-center"],["class","flex -space-x-2",4,"ngIf"],[1,"flex","items-center","gap-2"],["class","text-xs text-gray-500 flex items-center gap-1",3,"ngClass",4,"ngIf"],[1,"flex","items-center","gap-2","text-gray-400"],["class","flex items-center gap-1 text-xs",4,"ngIf"],[1,"relative"],[1,"p-1","rounded-full","hover:bg-gray-100","transition-colors",3,"click"],[1,"material-icons","text-sm","text-gray-400"],["class","absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-10 min-w-[120px]",4,"ngIf"],[1,"text-gray-600","text-xs","mb-3","line-clamp-2"],[1,"mb-3"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-xs","text-gray-500"],[1,"text-xs","text-gray-700","font-medium"],[1,"w-full","bg-gray-200","rounded-full","h-2"],[1,"bg-blue-500","h-2","rounded-full","transition-all","duration-300"],[1,"flex","justify-between","text-xs","text-gray-500","mb-3"],[4,"ngIf"],[1,"flex","flex-wrap","gap-1","mb-3"],["class","px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-md",4,"ngFor","ngForOf"],["class","px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-md",4,"ngIf"],[1,"px-2","py-1","bg-gray-100","text-gray-600","text-xs","rounded-md"],[1,"flex","-space-x-2"],["class","w-6 h-6 rounded-full bg-blue-500 flex items-center justify-center text-white text-xs font-medium border-2 border-white",3,"title",4,"ngFor","ngForOf"],["class","w-6 h-6 rounded-full bg-gray-400 flex items-center justify-center text-white text-xs font-medium border-2 border-white",4,"ngIf"],[1,"w-6","h-6","rounded-full","bg-blue-500","flex","items-center","justify-center","text-white","text-xs","font-medium","border-2","border-white",3,"title"],[1,"w-6","h-6","rounded-full","bg-gray-400","flex","items-center","justify-center","text-white","text-xs","font-medium","border-2","border-white"],[1,"text-xs","text-gray-500","flex","items-center","gap-1",3,"ngClass"],[1,"material-icons","text-sm"],[1,"flex","items-center","gap-1","text-xs"],[1,"absolute","right-0","top-8","bg-white","border","border-gray-200","rounded-lg","shadow-lg","py-1","z-10","min-w-[120px]"],[1,"w-full","text-left","px-3","py-2","text-sm","text-gray-700","hover:bg-gray-50","flex","items-center","gap-2",3,"click"],[1,"w-full","text-left","px-3","py-2","text-sm","text-red-600","hover:bg-red-50","flex","items-center","gap-2",3,"click"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1)(2,"h3",2),s(3),r(),n(4,"span",3),s(5),r()(),x(6,Se,2,1,"p",4)(7,Me,8,3,"div",5)(8,Ie,3,2,"div",6)(9,Ve,3,2,"div",7),n(10,"div",8),x(11,Le,3,2,"div",9),n(12,"div",10),x(13,Be,4,5,"span",11),n(14,"div",12),x(15,Oe,4,1,"span",13)(16,He,4,1,"span",13),r(),n(17,"div",14)(18,"button",15),_("click",function(g){return t.toggleMenu(g)}),n(19,"span",16),s(20,"more_vert"),r()(),x(21,Ue,9,0,"div",17),r()()()()),o&2&&(a(3),k(t.task.title),a(),m("ngClass",E(12,we,t.task.priority==="HIGH",t.task.priority==="MEDIUM",t.task.priority==="LOW")),a(),h(" ",t.task.priority," "),a(),m("ngIf",t.task.description),a(),m("ngIf",t.task.progress>0),a(),m("ngIf",t.task.estimatedHours||t.task.actualHours),a(),m("ngIf",t.task.tags&&t.task.tags.length>0),a(2),m("ngIf",t.task.assignedTo&&t.task.assignedTo.length>0),a(2),m("ngIf",t.task.deadline),a(2),m("ngIf",t.task.comments>0),a(),m("ngIf",t.task.attachments>0),a(5),m("ngIf",t.showMenu))},dependencies:[D,Y,I,P],styles:[".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}"]})}}return i})();function Ae(i,u){if(i&1){let e=b();n(0,"div",44),_("click",function(){let t=c(e).$implicit,l=f(3);return p(l.onTeamMemberToggle(t.id))}),n(1,"input",45),_("change",function(){let t=c(e).$implicit,l=f(3);return p(l.onTeamMemberToggle(t.id))}),r(),n(2,"div",46)(3,"div",47),s(4),r(),n(5,"div",48)(6,"div",49),s(7),r(),n(8,"div",50),s(9),r()()()()}if(i&2){let e=u.$implicit,o=f(3);a(),m("checked",o.isTeamMemberSelected(e.id)),a(3),h(" ",e.name.charAt(0).toUpperCase()," "),a(3),k(e.name),a(2),k(e.role)}}function Re(i,u){if(i&1&&(n(0,"div",42),x(1,Ae,10,4,"div",43),r()),i&2){let e=f(2);a(),m("ngForOf",e.availableTeamMembers)}}function Ge(i,u){i&1&&(n(0,"div",51),s(1," Aucun membre d'\xE9quipe disponible pour ce projet "),r())}function ze(i,u){if(i&1&&(n(0,"div",9)(1,"label",38),s(2," Assigner \xE0 l'\xE9quipe "),r(),n(3,"div",39),s(4),r(),x(5,Re,2,1,"div",40)(6,Ge,2,0,"div",41),r()),i&2){let e=f();a(4),h(" Projet: ",e.selectedProject.title," "),a(),m("ngIf",e.availableTeamMembers.length>0),a(),m("ngIf",e.availableTeamMembers.length===0)}}function $e(i,u){i&1&&(n(0,"div",9)(1,"div",52)(2,"div",53),s(3," Veuillez s\xE9lectionner un projet dans le tableau de bord pour cr\xE9er une t\xE2che. "),r()()())}var ve=(()=>{class i{constructor(){this.task=null,this.selectedProject=null,this.save=new S,this.cancel=new S,this.ProjectManagementStage=T,this.isNewTask=!0,this.tagsString="",this.availableTeamMembers=[],this.selectedTeamMemberIds=[],this.formData={title:"",description:"",stage:T.PENDING,progress:0,priority:"MEDIUM",projectId:"",tags:[],estimatedHours:0,actualHours:0,assignedTo:[],comments:0,attachments:0}}ngOnInit(){this.selectedProject&&(this.availableTeamMembers=this.selectedProject.team||[],this.formData.projectId=this.selectedProject.id),this.task&&(this.isNewTask=!1,this.formData=C({},this.task),this.tagsString=this.task.tags?.join(", ")||"",this.selectedTeamMemberIds=this.task.assignedTo?.map(e=>e.id)||[],this.task.deadline&&(this.formData.deadline=new Date(this.task.deadline)))}onTeamMemberToggle(e){let o=this.selectedTeamMemberIds.indexOf(e);o>-1?this.selectedTeamMemberIds.splice(o,1):this.selectedTeamMemberIds.push(e),this.formData.assignedTo=this.availableTeamMembers.filter(t=>this.selectedTeamMemberIds.includes(t.id))}isTeamMemberSelected(e){return this.selectedTeamMemberIds.includes(e)}onSubmit(){this.formData.tags=this.tagsString.split(",").map(e=>e.trim()).filter(e=>e.length>0),this.formData.assignedTo=this.availableTeamMembers.filter(e=>this.selectedTeamMemberIds.includes(e.id)),this.save.emit(this.formData)}onCancel(){this.cancel.emit()}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=j({type:i,selectors:[["app-task-form"]],inputs:{task:"task",selectedProject:"selectedProject"},outputs:{save:"save",cancel:"cancel"},decls:71,vars:22,consts:[["taskForm","ngForm"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"bg-white","rounded-lg","shadow-xl","w-full","max-w-2xl","max-h-[90vh]","overflow-y-auto"],[1,"p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-xl","font-semibold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","transition-colors",3,"click"],[1,"material-icons"],[3,"ngSubmit"],[1,"mb-4"],["for","title",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","id","title","name","title","required","","placeholder","Entrez le titre de la t\xE2che",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["for","description",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","description","name","description","rows","3","placeholder","D\xE9crivez la t\xE2che...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["class","mb-4",4,"ngIf"],[1,"grid","grid-cols-2","gap-4","mb-4"],["for","stage",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","stage","name","stage",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],[3,"value"],["for","priority",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","priority","name","priority",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["value","LOW"],["value","MEDIUM"],["value","HIGH"],["for","progress",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","number","id","progress","name","progress","min","0","max","100",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["for","deadline",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","date","id","deadline","name","deadline",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["for","estimatedHours",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","number","id","estimatedHours","name","estimatedHours","min","0","step","0.5",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["for","actualHours",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","number","id","actualHours","name","actualHours","min","0","step","0.5",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],[1,"mb-6"],["for","tags",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","id","tags","name","tags","placeholder","frontend, urgent, bug...",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],[1,"flex","justify-end","gap-3"],["type","button",1,"px-4","py-2","text-gray-700","bg-gray-100","rounded-md","hover:bg-gray-200","transition-colors",3,"click"],["type","submit",1,"px-4","py-2","bg-blue-600","text-white","rounded-md","hover:bg-blue-700","disabled:bg-gray-300","disabled:cursor-not-allowed","transition-colors",3,"disabled"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],[1,"text-xs","text-gray-500","mb-3"],["class","space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-md p-3",4,"ngIf"],["class","text-sm text-gray-500 italic p-3 border border-gray-200 rounded-md",4,"ngIf"],[1,"space-y-2","max-h-32","overflow-y-auto","border","border-gray-200","rounded-md","p-3"],["class","flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-md cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"flex","items-center","space-x-3","p-2","hover:bg-gray-50","rounded-md","cursor-pointer",3,"click"],["type","checkbox",1,"h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300","rounded",3,"change","checked"],[1,"flex","items-center","space-x-2","flex-1"],[1,"w-8","h-8","bg-blue-500","rounded-full","flex","items-center","justify-center","text-white","text-sm","font-medium"],[1,"flex-1"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"text-sm","text-gray-500","italic","p-3","border","border-gray-200","rounded-md"],[1,"p-3","bg-yellow-50","border","border-yellow-200","rounded-md"],[1,"text-sm","text-yellow-800"]],template:function(o,t){if(o&1){let l=b();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h2",5),s(5),r(),n(6,"button",6),_("click",function(){return c(l),p(t.onCancel())}),n(7,"span",7),s(8,"close"),r()()(),n(9,"form",8,0),_("ngSubmit",function(){return c(l),p(t.onSubmit())}),n(11,"div",9)(12,"label",10),s(13," Titre de la t\xE2che * "),r(),n(14,"input",11),w("ngModelChange",function(d){return c(l),y(t.formData.title,d)||(t.formData.title=d),p(d)}),r()(),n(15,"div",9)(16,"label",12),s(17," Description "),r(),n(18,"textarea",13),w("ngModelChange",function(d){return c(l),y(t.formData.description,d)||(t.formData.description=d),p(d)}),r()(),x(19,ze,7,3,"div",14)(20,$e,4,0,"div",14),n(21,"div",15)(22,"div")(23,"label",16),s(24," \xC9tape "),r(),n(25,"select",17),w("ngModelChange",function(d){return c(l),y(t.formData.stage,d)||(t.formData.stage=d),p(d)}),n(26,"option",18),s(27),r(),n(28,"option",18),s(29),r(),n(30,"option",18),s(31),r(),n(32,"option",18),s(33),r()()(),n(34,"div")(35,"label",19),s(36," Priorit\xE9 "),r(),n(37,"select",20),w("ngModelChange",function(d){return c(l),y(t.formData.priority,d)||(t.formData.priority=d),p(d)}),n(38,"option",21),s(39,"Basse"),r(),n(40,"option",22),s(41,"Moyenne"),r(),n(42,"option",23),s(43,"Haute"),r()()()(),n(44,"div",15)(45,"div")(46,"label",24),s(47," Progression (%) "),r(),n(48,"input",25),w("ngModelChange",function(d){return c(l),y(t.formData.progress,d)||(t.formData.progress=d),p(d)}),r()(),n(49,"div")(50,"label",26),s(51," Date limite "),r(),n(52,"input",27),w("ngModelChange",function(d){return c(l),y(t.formData.deadline,d)||(t.formData.deadline=d),p(d)}),r()()(),n(53,"div",15)(54,"div")(55,"label",28),s(56," Heures estim\xE9es "),r(),n(57,"input",29),w("ngModelChange",function(d){return c(l),y(t.formData.estimatedHours,d)||(t.formData.estimatedHours=d),p(d)}),r()(),n(58,"div")(59,"label",30),s(60," Heures r\xE9elles "),r(),n(61,"input",31),w("ngModelChange",function(d){return c(l),y(t.formData.actualHours,d)||(t.formData.actualHours=d),p(d)}),r()()(),n(62,"div",32)(63,"label",33),s(64," Tags (s\xE9par\xE9s par des virgules) "),r(),n(65,"input",34),w("ngModelChange",function(d){return c(l),y(t.tagsString,d)||(t.tagsString=d),p(d)}),r()(),n(66,"div",35)(67,"button",36),_("click",function(){return c(l),p(t.onCancel())}),s(68," Annuler "),r(),n(69,"button",37),s(70),r()()()()()()}if(o&2){let l=M(10);a(5),h(" ",t.isNewTask?"Cr\xE9er une nouvelle t\xE2che":"Modifier la t\xE2che"," "),a(9),v("ngModel",t.formData.title),a(4),v("ngModel",t.formData.description),a(),m("ngIf",t.selectedProject),a(),m("ngIf",!t.selectedProject),a(5),v("ngModel",t.formData.stage),a(),m("value",t.ProjectManagementStage.PENDING),a(),k(t.ProjectManagementStage.PENDING),a(),m("value",t.ProjectManagementStage.INPROGRESS),a(),k(t.ProjectManagementStage.INPROGRESS),a(),m("value",t.ProjectManagementStage.TEST),a(),k(t.ProjectManagementStage.TEST),a(),m("value",t.ProjectManagementStage.DONE),a(),k(t.ProjectManagementStage.DONE),a(4),v("ngModel",t.formData.priority),a(11),v("ngModel",t.formData.progress),a(4),v("ngModel",t.formData.deadline),a(5),v("ngModel",t.formData.estimatedHours),a(4),v("ngModel",t.formData.actualHours),a(4),v("ngModel",t.tagsString),a(4),m("disabled",!l.form.valid),a(),h(" ",t.isNewTask?"Cr\xE9er":"Modifier"," ")}},dependencies:[D,I,P,W,pe,H,U,de,ue,O,L,me,_e,fe,ge,B,ce],encapsulation:2})}}return i})();var ye=(()=>{class i{constructor(e,o){this.http=e,this.jwtService=o,this.apiUrl=`${ie.apiProjectManagementURL}`,this.tasksSubject=new $([]),this.tasks$=this.tasksSubject.asObservable(),this.mockTasks=[]}getAuthHeaders(){let e=this.jwtService.getToken();return new ee({"Content-Type":"application/json",Authorization:`Bearer ${e}`})}getTasks(){return this.http.get(this.apiUrl,{headers:this.getAuthHeaders()})}getTasksByProject(e){return this.http.get(`${this.apiUrl}/project/${e}`,{headers:this.getAuthHeaders()})}createTask(e){return this.http.post(this.apiUrl,e,{headers:this.getAuthHeaders()})}updateTask(e,o){return this.http.patch(`${this.apiUrl}/${e}`,o,{headers:this.getAuthHeaders()})}updateTaskStage(e,o){return this.http.patch(`${this.apiUrl}/${e}/stage`,{stage:o},{headers:this.getAuthHeaders()})}deleteTask(e){return this.http.delete(`${this.apiUrl}/${e}`,{headers:this.getAuthHeaders()})}assignUsersToTask(e,o){return this.http.post(`${this.apiUrl}/${e}/assign`,{userIds:o},{headers:this.getAuthHeaders()})}removeUserFromTask(e,o){return this.http.delete(`${this.apiUrl}/${e}/assign/${o}`,{headers:this.getAuthHeaders()})}getTaskStatistics(e){return this.http.get(`${this.apiUrl}/project/${e}/statistics`,{headers:this.getAuthHeaders()})}addTaskLocally(e){let o=V(C({},e),{id:this.generateId(),createdAt:new Date,updatedAt:new Date});this.mockTasks.push(o),this.tasksSubject.next([...this.mockTasks])}updateTaskLocally(e,o){let t=this.mockTasks.findIndex(l=>l.id===e);t!==-1&&(this.mockTasks[t]=V(C(C({},this.mockTasks[t]),o),{updatedAt:new Date}),this.tasksSubject.next([...this.mockTasks]))}deleteTaskLocally(e){this.mockTasks=this.mockTasks.filter(o=>o.id!==e),this.tasksSubject.next([...this.mockTasks])}getTasksLocally(){return[...this.mockTasks]}generateId(){return Math.random().toString(36).substr(2,9)}static{this.\u0275fac=function(o){return new(o||i)(G(te),G(ne))}}static{this.\u0275prov=q({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var A=(i,u,e)=>[i,u,e];function Je(i,u){i&1&&N(0,"app-loader")}function Ke(i,u){if(i&1&&(n(0,"option",30),s(1),r()),i&2){let e=u.$implicit;m("value",e.id),a(),h(" ",e.title," ")}}function Qe(i,u){if(i&1&&(n(0,"div",31)(1,"span",32),s(2),r(),n(3,"span"),s(4),r()()),i&2){let e=f();a(2),k(e.selectedProject.stage),a(2),h("",e.selectedProject.team.length," membre(s)")}}function Xe(i,u){i&1&&(n(0,"div",33),s(1," Veuillez s\xE9lectionner un projet pour voir et g\xE9rer ses t\xE2ches. "),r())}function Ye(i,u){if(i&1){let e=b();n(0,"app-task-card",34),_("edit",function(t){c(e);let l=f();return p(l.editTask(t))})("delete",function(t){c(e);let l=f();return p(l.deleteTask(t))})("removeUser",function(t){c(e);let l=f();return p(l.onRemoveUser(t))}),r()}if(i&2){let e=u.$implicit;m("task",e)("cdkDragData",e)}}function Ze(i,u){if(i&1){let e=b();n(0,"app-task-card",34),_("edit",function(t){c(e);let l=f();return p(l.editTask(t))})("delete",function(t){c(e);let l=f();return p(l.deleteTask(t))})("removeUser",function(t){c(e);let l=f();return p(l.onRemoveUser(t))}),r()}if(i&2){let e=u.$implicit;m("task",e)("cdkDragData",e)}}function et(i,u){if(i&1){let e=b();n(0,"app-task-card",34),_("edit",function(t){c(e);let l=f();return p(l.editTask(t))})("delete",function(t){c(e);let l=f();return p(l.deleteTask(t))})("removeUser",function(t){c(e);let l=f();return p(l.onRemoveUser(t))}),r()}if(i&2){let e=u.$implicit;m("task",e)("cdkDragData",e)}}function tt(i,u){if(i&1){let e=b();n(0,"app-task-card",34),_("edit",function(t){c(e);let l=f();return p(l.editTask(t))})("delete",function(t){c(e);let l=f();return p(l.deleteTask(t))})("removeUser",function(t){c(e);let l=f();return p(l.onRemoveUser(t))}),r()}if(i&2){let e=u.$implicit;m("task",e)("cdkDragData",e)}}function it(i,u){if(i&1){let e=b();n(0,"app-task-form",35),_("save",function(t){c(e);let l=f();return p(l.saveTask(t))})("cancel",function(){c(e);let t=f();return p(t.closeTaskForm())}),r()}if(i&2){let e=f();m("task",e.selectedTask)("selectedProject",e.selectedProject)}}var Nt=(()=>{class i{constructor(e,o,t){this.projectManagementService=e,this.projectService=o,this.loaderService=t,this.ProjectManagementStage=T,this.pendingTasks=[],this.inProgressTasks=[],this.testTasks=[],this.doneTasks=[],this.selectedTask=null,this.showTaskForm=!1,this.isNewTask=!0,this.projects=[],this.selectedProjectId="",this.selectedProject=null,this.selectedTaskId=null,this.isLoading$=this.loaderService.isLoading$}ngOnInit(){this.loadProjects(),this.loadTasks(),this.projectManagementService.tasks$.subscribe(e=>{this.organizeTasks(e)})}loadTasks(){this.selectedProjectId&&this.projectManagementService.getTasksByProject(this.selectedProjectId).subscribe(e=>{this.organizeTasks(e)})}loadProjects(){this.projectService.getProjects().subscribe(e=>{this.projects=e})}onProjectChange(e){this.selectedProject=this.projects.find(o=>o.id===e)||null,e?this.projectManagementService.getTasksByProject(e).subscribe(o=>{this.organizeTasks(o)}):this.organizeTasks([])}organizeTasks(e){let o=this.selectedProjectId?e.filter(t=>t.projectId===this.selectedProjectId):e;this.pendingTasks=o.filter(t=>t.stage===T.PENDING),this.inProgressTasks=o.filter(t=>t.stage===T.INPROGRESS),this.testTasks=o.filter(t=>t.stage===T.TEST),this.doneTasks=o.filter(t=>t.stage===T.DONE)}drop(e){if(e.previousContainer===e.container)re(e.container.data,e.previousIndex,e.currentIndex);else{ae(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex);let o=e.container.data[e.currentIndex],t;if(e.container.data===this.pendingTasks)t=T.PENDING;else if(e.container.data===this.inProgressTasks)t=T.INPROGRESS;else if(e.container.data===this.testTasks)t=T.TEST;else if(e.container.data===this.doneTasks)t=T.DONE;else return;o.stage=t,t===T.DONE&&(o.progress=100),this.projectManagementService.updateTaskStage(o.id,t).subscribe(()=>{this.loadTasks()})}}openTaskForm(e=T.PENDING){this.isNewTask=!0,this.selectedTask=null,this.showTaskForm=!0}editTask(e){this.isNewTask=!1,this.selectedTask=e,this.showTaskForm=!0}deleteTask(e){confirm("\xCAtes-vous s\xFBr de vouloir supprimer cette t\xE2che ?")&&this.projectManagementService.deleteTask(e.id).subscribe(()=>{this.loadTasks()})}closeTaskForm(){this.showTaskForm=!1,this.selectedTask=null}saveTask(e){if(this.isNewTask){let o=V(C({},e),{projectId:this.selectedProjectId});this.projectManagementService.createTask(o).subscribe(()=>{this.loadTasks(),this.closeTaskForm()})}else if(this.selectedTask){let o=e;delete e.createdAt,delete e.updatedAt,delete e.id,delete o.project,this.projectManagementService.updateTask(this.selectedTask.id,e).subscribe(()=>{this.loadTasks(),this.closeTaskForm()})}}onRemoveUser(e){console.log("Removing user",e.userId,"from task",e.taskId)}get selectedTaskAssignedIds(){if(!this.selectedTaskId)return[];let o=[...this.pendingTasks,...this.inProgressTasks,...this.testTasks,...this.doneTasks].find(t=>t.id===this.selectedTaskId);return o?o.assignedTo.map(t=>t.id):[]}static{this.\u0275fac=function(o){return new(o||i)(F(ye),F(ke),F(he))}}static{this.\u0275cmp=j({type:i,selectors:[["app-project-management-board"]],decls:70,vars:45,consts:[["pendingList","cdkDropList"],["inProgressList","cdkDropList"],["testList","cdkDropList"],["doneList","cdkDropList"],[4,"ngIf"],[1,"p-6","h-[calc(100vh-64px)]","overflow-hidden","flex","flex-col"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-2xl","font-semibold","text-gray-800"],[1,"flex","items-center","gap-2","bg-secondary","text-white","px-4","py-2","rounded-md","font-medium","cursor-pointer","transition-colors","hover:bg-primary-light",3,"click","disabled"],[1,"material-icons","text-lg"],[1,"mb-6","bg-white","rounded-lg","border","border-gray-200","p-4"],[1,"flex","items-center","gap-4"],["for","projectSelect",1,"text-sm","font-medium","text-gray-700","whitespace-nowrap"],["id","projectSelect",1,"flex-1","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","flex items-center gap-2 text-sm text-gray-600",4,"ngIf"],["class","mt-3 text-sm text-gray-500",4,"ngIf"],[1,"flex","gap-5","overflow-x-auto","pb-4","h-full"],[1,"flex-1","min-w-[300px]","max-w-[350px]","bg-gray-50","rounded-lg","p-4","flex","flex-col","h-full"],[1,"flex","items-center","mb-4"],[1,"text-base","font-semibold","text-gray-700","m-0"],[1,"ml-2","px-2","py-0.5","bg-gray-200","rounded-full","text-xs","text-gray-600"],[1,"ml-auto","flex","items-center","justify-center","w-7","h-7","rounded-full","bg-gray-200","text-gray-600","border-none","cursor-pointer","transition-colors","hover:bg-secondary","hover:text-white",3,"click"],["cdkDropList","",1,"flex-grow","overflow-y-auto","min-h-[100px]","p-1",3,"cdkDropListDropped","cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","","class","mb-4",3,"task","cdkDragData","edit","delete","removeUser",4,"ngFor","ngForOf"],[1,"ml-2","px-2","py-0.5","bg-blue-200","rounded-full","text-xs","text-blue-800"],[1,"ml-2","px-2","py-0.5","bg-yellow-200","rounded-full","text-xs","text-yellow-800"],[1,"ml-2","px-2","py-0.5","bg-green-200","rounded-full","text-xs","text-green-800"],[3,"task","selectedProject","save","cancel",4,"ngIf"],[3,"value"],[1,"flex","items-center","gap-2","text-sm","text-gray-600"],[1,"px-2","py-1","bg-gray-100","rounded-md"],[1,"mt-3","text-sm","text-gray-500"],["cdkDrag","",1,"mb-4",3,"edit","delete","removeUser","task","cdkDragData"],[3,"save","cancel","task","selectedProject"]],template:function(o,t){if(o&1){let l=b();x(0,Je,1,0,"app-loader",4),Q(1,"async"),n(2,"div",5)(3,"div",6)(4,"h1",7),s(5,"Gestion de Projet"),r(),n(6,"button",8),_("click",function(){return c(l),p(t.openTaskForm())}),n(7,"span",9),s(8,"add"),r(),s(9," Cr\xE9er t\xE2che "),r()(),n(10,"div",10)(11,"div",11)(12,"label",12),s(13," Projet actuel : "),r(),n(14,"select",13),w("ngModelChange",function(d){return c(l),y(t.selectedProjectId,d)||(t.selectedProjectId=d),p(d)}),_("ngModelChange",function(d){return c(l),p(t.onProjectChange(d))}),n(15,"option",14),s(16,"S\xE9lectionnez un projet"),r(),x(17,Ke,2,2,"option",15),r(),x(18,Qe,5,2,"div",16),r(),x(19,Xe,2,0,"div",17),r(),n(20,"div",18)(21,"div",19)(22,"div",20)(23,"h2",21),s(24),r(),n(25,"span",22),s(26),r(),n(27,"button",23),_("click",function(){return c(l),p(t.openTaskForm(t.ProjectManagementStage.PENDING))}),n(28,"span",9),s(29,"add"),r()()(),n(30,"div",24,0),_("cdkDropListDropped",function(d){return c(l),p(t.drop(d))}),x(32,Ye,1,2,"app-task-card",25),r()(),n(33,"div",19)(34,"div",20)(35,"h2",21),s(36),r(),n(37,"span",26),s(38),r(),n(39,"button",23),_("click",function(){return c(l),p(t.openTaskForm(t.ProjectManagementStage.INPROGRESS))}),n(40,"span",9),s(41,"add"),r()()(),n(42,"div",24,1),_("cdkDropListDropped",function(d){return c(l),p(t.drop(d))}),x(44,Ze,1,2,"app-task-card",25),r()(),n(45,"div",19)(46,"div",20)(47,"h2",21),s(48),r(),n(49,"span",27),s(50),r(),n(51,"button",23),_("click",function(){return c(l),p(t.openTaskForm(t.ProjectManagementStage.TEST))}),n(52,"span",9),s(53,"add"),r()()(),n(54,"div",24,2),_("cdkDropListDropped",function(d){return c(l),p(t.drop(d))}),x(56,et,1,2,"app-task-card",25),r()(),n(57,"div",19)(58,"div",20)(59,"h2",21),s(60),r(),n(61,"span",28),s(62),r(),n(63,"button",23),_("click",function(){return c(l),p(t.openTaskForm(t.ProjectManagementStage.DONE))}),n(64,"span",9),s(65,"add"),r()()(),n(66,"div",24,3),_("cdkDropListDropped",function(d){return c(l),p(t.drop(d))}),x(68,tt,1,2,"app-task-card",25),r()()()(),x(69,it,1,2,"app-task-form",29)}if(o&2){let l=M(31),g=M(43),d=M(55),R=M(67);m("ngIf",X(1,27,t.isLoading$)),a(6),m("disabled",!t.selectedProjectId),a(8),v("ngModel",t.selectedProjectId),a(3),m("ngForOf",t.projects),a(),m("ngIf",t.selectedProject),a(),m("ngIf",!t.selectedProjectId),a(5),k(t.ProjectManagementStage.PENDING),a(2),k(t.pendingTasks.length),a(4),m("cdkDropListData",t.pendingTasks)("cdkDropListConnectedTo",E(29,A,g,d,R)),a(2),m("ngForOf",t.pendingTasks),a(4),k(t.ProjectManagementStage.INPROGRESS),a(2),k(t.inProgressTasks.length),a(4),m("cdkDropListData",t.inProgressTasks)("cdkDropListConnectedTo",E(33,A,l,d,R)),a(2),m("ngForOf",t.inProgressTasks),a(4),k(t.ProjectManagementStage.TEST),a(2),k(t.testTasks.length),a(4),m("cdkDropListData",t.testTasks)("cdkDropListConnectedTo",E(37,A,l,g,R)),a(2),m("ngForOf",t.testTasks),a(4),k(t.ProjectManagementStage.DONE),a(2),k(t.doneTasks.length),a(4),m("cdkDropListData",t.doneTasks)("cdkDropListConnectedTo",E(41,A,l,g,d)),a(2),m("ngForOf",t.doneTasks),a(),m("ngIf",t.showTaskForm)}},dependencies:[D,I,P,Z,le,se,oe,be,ve,xe,W,H,U,O,L,B],encapsulation:2})}}return i})();export{Nt as ProjectManagementBoardComponent};
