<div class="booking-container">
  <div class="page-header">
    <h1 class="page-title">
      <svg class="title-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
      </svg>
      Système de Réservation
    </h1>
    <p class="page-subtitle">Planifiez votre rendez-vous en quelques clics</p>
  </div>

  <div class="main-grid">
    <div class="calendar-section">
      <div class="calendar-wrapper">
        <div class="calendar-header">
          <h2 class="calendar-title">
            {{ monthNames[selectedDate.getMonth()] }} {{ selectedDate.getFullYear() }}
          </h2>
          <div class="nav-buttons">
            <button class="nav-btn" (click)="previousMonth()">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
              </svg>
            </button>
            <button class="nav-btn" (click)="nextMonth()">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </button>
          </div>
        </div>

        <div class="day-headers">
          <div *ngFor="let day of dayNames" class="day-header">{{ day }}</div>
        </div>

        <div class="calendar-grid">
          <button
            *ngFor="let day of getDaysInMonth(selectedDate)"
            class="calendar-day"
            [class.invisible]="!day"
            [class.disabled]="day && !isDateAvailable(day)"
            [class.selected]="day && formatDate(day) === formatDate(selectedDate)"
            [class.has-bookings]="day && getBookingsForDate(formatDate(day)).length > 0"
            [disabled]="!day || !isDateAvailable(day)"
            (click)="day && handleDateSelect(day)"
          >
            {{ day?.getDate() }}
          </button>
        </div>
      </div>

      <div *ngIf="selectedDate" class="time-slots-section">
        <div class="section-header">
          <svg class="section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <h3 class="section-title">Créneaux disponibles - {{ formatDate(selectedDate) }}</h3>
        </div>
        
        <div class="time-grid">
          <button
            *ngFor="let slot of timeSlots"
            class="time-slot"
            [class.disabled]="!slot.available || isTimeSlotBooked(slot.time)"
            [class.selected]="selectedTime === slot.time"
            [disabled]="!slot.available || isTimeSlotBooked(slot.time)"
            (click)="slot.available && !isTimeSlotBooked(slot.time) && handleTimeSelect(slot.time)"
          >
            {{ slot.time }}
          </button>
        </div>
      </div>
    </div>

    <div class="sidebar">
      <div class="sidebar-card">
        <div class="section-header">
          <svg class="section-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5-5-5h5V4h5v13z"></path>
          </svg>
          <h3 class="section-title">Notifications</h3>
        </div>
        
        <div class="notification-settings">
          <label class="checkbox-item">
            <input
              type="checkbox"
              [checked]="notifications.emailNotifications"
              (change)="updateNotificationSetting('emailNotifications', $event.target.checked)"
            />
            <span>Notifications par email</span>
          </label>
          
          <label class="checkbox-item">
            <input
              type="checkbox"
              [checked]="notifications.reminder24h"
              (change)="updateNotificationSetting('reminder24h', $event.target.checked)"
            />
            <span>Rappel J-1</span>
          </label>
          
          <label class="checkbox-item">
            <input
              type="checkbox"
              [checked]="notifications.reminder1h"
              (change)="updateNotificationSetting('reminder1h', $event.target.checked)"
            />
            <span>Rappel H-1</span>
          </label>
        </div>
      </div>

      <div class="sidebar-card">
        <h3 class="section-title">Réservations à venir</h3>
        
        <div class="bookings-list">
          <div
            *ngFor="let booking of getUpcomingBookings()"
            class="booking-item"
          >
            <div class="booking-info">
              <h4 class="booking-name">{{ booking.clientName }}</h4>
              <p class="booking-service">{{ booking.service }}</p>
              <p class="booking-datetime">{{ booking.date }} à {{ booking.time }}</p>
            </div>
            <button class="cancel-btn" (click)="cancelBooking(booking.id)">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          
          <div *ngIf="getUpcomingBookings().length === 0" class="empty-state">
            <p>Aucune réservation à venir</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="showBookingForm" class="modal-overlay">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Nouvelle réservation</h3>
        <button class="close-btn" (click)="closeBookingForm()">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <div class="selected-time-info">
        <p><strong>{{ formatDate(selectedDate) }} à {{ selectedTime }}</strong></p>
      </div>

      <form [formGroup]="bookingForm" (ngSubmit)="handleBookingSubmit()" class="booking-form">
        <div class="form-group">
          <label>Nom complet</label>
          <input type="text" formControlName="name" class="form-input" />
        </div>

        <div class="form-group">
          <label>Email</label>
          <input type="email" formControlName="email" class="form-input" />
        </div>

        <div class="form-group">
          <label>Téléphone</label>
          <input type="tel" formControlName="phone" class="form-input" />
        </div>

        <div class="form-group">
          <label>Service</label>
          <select formControlName="service" class="form-select">
            <option value="">Sélectionner un service</option>
            <option *ngFor="let service of services" [value]="service">{{ service }}</option>
          </select>
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-secondary" (click)="closeBookingForm()">
            Annuler
          </button>
          <button type="submit" class="btn btn-primary" [disabled]="!bookingForm.valid">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            Confirmer
          </button>
        </div>
      </form>
    </div>
  </div>
</div>