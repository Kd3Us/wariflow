<div class="modal-overlay" [class.show]="isOpen" (click)="onCancel()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Ajouter des utilisateurs au projet</h3>
      <button class="close-btn" (click)="onCancel()">&times;</button>
    </div>

    <div class="modal-body">
      <form [formGroup]="searchForm" class="search-form">
        <div class="search-input-container">
          <input
            type="text"
            formControlName="searchTerm"
            placeholder="Rechercher par nom, email ou rôle..."
            class="search-input"
          >
          <span class="search-icon">🔍</span>
        </div>
      </form>

      <div class="users-list" *ngIf="!loading">
        <div 
          *ngFor="let user of filteredUsers" 
          class="user-item"
          [class.selected]="isUserSelected(user.id)"
          (click)="toggleUserSelection(user.id)"
        >
          <div class="user-avatar">
            <img [src]="user.avatar" [alt]="user.name" *ngIf="user.avatar">
            <div class="avatar-placeholder" *ngIf="!user.avatar">
              {{ user.name.charAt(0).toUpperCase() }}
            </div>
          </div>
          
          <div class="user-info">
            <div class="user-name">{{ user.name }}</div>
            <div class="user-details">
              <span class="user-role">{{ user.role }}</span>
              <span class="user-email">{{ user.email }}</span>
            </div>
          </div>
          
          <div class="selection-indicator" *ngIf="isUserSelected(user.id)">
            ✓
          </div>
        </div>

        <div class="no-users" *ngIf="filteredUsers.length === 0">
          Aucun utilisateur disponible
        </div>
      </div>

      <div class="loading" *ngIf="loading">
        Chargement des utilisateurs...
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="onCancel()">
        Annuler
      </button>
      <button 
        class="btn btn-primary" 
        (click)="onConfirm()"
        [disabled]="selectedUsers.length === 0"
      >
        Ajouter {{ selectedUsers.length }} utilisateur(s)
      </button>
    </div>
  </div>
</div>